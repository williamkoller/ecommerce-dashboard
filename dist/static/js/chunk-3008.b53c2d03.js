(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3008"],{HKPr:function(t,e,a){"use strict";var o=a("YPLS");a.n(o).a},Mz3J:function(t,e,a){"use strict";Math.easeInOutQuad=function(t,e,a,o){return(t/=o/2)<1?a/2*t*t+e:-a/2*(--t*(t-2)-1)+e};var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};function i(t,e,a){var i=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,n=t-i,r=0;e=void 0===e?500:e;!function t(){r+=20,function(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}(Math.easeInOutQuad(r,i,n,e)),r<e?o(t):a&&"function"==typeof a&&a()}()}var n={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(t){this.$emit("update:page",t)}},pageSize:{get:function(){return this.limit},set:function(t){this.$emit("update:limit",t)}}},methods:{handleSizeChange:function(t){this.$emit("pagination",{page:this.currentPage,limit:t}),this.autoScroll&&i(0,800)},handleCurrentChange:function(t){this.$emit("pagination",{page:t,limit:this.pageSize}),this.autoScroll&&i(0,800)}}},r=(a("HKPr"),a("KHd+")),s=Object(r.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pagination-container",class:{hidden:t.hidden}},[a("el-pagination",t._b({attrs:{background:t.background,"current-page":t.currentPage,"page-size":t.pageSize,layout:t.layout,"page-sizes":t.pageSizes,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},"el-pagination",t.$attrs,!1))],1)},[],!1,null,"cebf2f0c",null);s.options.__file="index.vue";e.a=s.exports},YPLS:function(t,e,a){},op5U:function(t,e,a){"use strict";a.r(e);var o=a("m1cH"),i=a.n(o),n=a("QbLZ"),r=a.n(n),s=a("P2sY"),l=a.n(s),c=a("Mz3J"),u=a("L2JU"),d=a("7Qib"),p={id:void 0,code:void 0,valid_from:void 0,valid_until:void 0,quantity:0,type:"percent",recursive:!1,discount:0},m={name:"CouponsListing",components:{Pagination:c.a},data:function(){return{loading:!1,formData:l()({},p),query:{title:void 0,page:this.coupons&&this.coupons.pagination.page?this.coupons.pagination.page:1,limit:10},editDialog:!1,confirmDeleteDialog:!1,discountType:"percent",valid_period:!1,valid_range:[],clientList:[],productList:[],searchingProducts:!1,searchingClients:!1,couponCode:""}},computed:r()({},Object(u.b)({products:"products",clients:"users",coupons:"coupons",coupon:"currentCoupon"}),{precision:function(){switch(this.formData.type){case"percent":return 0;case"currency":return 2;default:return 0}},maxDiscountValue:function(){switch(this.formData.type){case"percent":return 100;case"currency":return 9999999;default:return 0}}}),watch:{discountType:function(t){this.formData.type=t,this.editDialog&&(this.formData.discount=0)},valid_range:function(t){this.formData.valid_from=t[0],this.formData.valid_until=t[1]},couponCode:function(t){this.couponCode=Object(d.f)(t).toUpperCase(),this.formData.code=Object(d.f)(t).toUpperCase()}},created:function(){this.$route.query&&this.$route.query.page&&(this.query.page=parseInt(this.$route.query.page))},mounted:function(){this.fetch()},methods:{fetch:function(){return this.updateQueryParameters(),this.$store.dispatch("fetchCoupons",this.query)},fillForm:function(){var t,e;this.formData=l()({},this.coupon),this.couponCode=this.formData.code,this.discountType=this.formData.type,this.formData.users=this.coupon.users.map(function(t){return t.id}),this.formData.products=this.coupon.products.map(function(t){return t.id}),(t=this.clientList).push.apply(t,i()(this.coupon.users)),(e=this.productList).push.apply(e,i()(this.coupon.products)),this.coupon.valid_from&&(this.valid_period=!0,this.valid_range=[Date.parse(this.coupon.valid_from),Date.parse(this.coupon.valid_until)])},handleCreate:function(){this.formData=l()({},p),this.editDialog=!0,this.valid_period=!1,this.valid_range=[]},handleSearch:function(){var t=this;this.loading=!0,this.fetch().then(function(){return t.loading=!1})},handleClearSearch:function(){var t=this;this.query.title=void 0,this.loading=!0,this.fetch().then(function(){return t.loading=!1})},handleEdit:function(t){var e=this;this.$store.dispatch("findCoupon",t).then(function(){e.fillForm(),setTimeout(function(){e.editDialog=!0},100)}).catch(function(t){return console.error(t)})},handleSave:function(){var t=this;this.$store.dispatch("saveCoupon",this.formData).then(function(){t.$message({message:"Salvo com Sucesso!",type:"success",duration:3e3})})},handleDelete:function(){var t=this;this.$store.dispatch("destroyCoupon",this.formData.id).then(function(){t.editDialog=!1,t.confirmDeleteDialog=!1,t.formData={},t.$message({message:"Deletado com sucesso!",type:"warning",duation:3e3})})},handleSearchClients:function(t){var e=this;t.length<3||(this.searchingClients=!0,this.$store.dispatch("fetchUsers",{name:t}).then(function(){var t;(t=e.clientList).push.apply(t,i()(e.clients.data)),e.searchingClients=!1}))},handleSearchProducts:function(t){var e=this;this.searchingProducts=!0,this.$store.dispatch("fetchProducts",{title:t}).then(function(){var t;(t=e.productList).push.apply(t,i()(e.products.data)),e.searchingProducts=!1})},formatDiscountValue:function(t){switch(t.type){case"percent":return t.discount+"%";case"currency":return"R$ "+t.discount.toFixed(2);default:return"Total"}},updateQueryParameters:function(){this.query.page>1?this.$router.replace({query:{page:this.query.page}}):1===this.query.page&&this.$router.replace({query:{}})}}},f=a("KHd+"),h=Object(f.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("Novo Cupom")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.coupons.data.filter(function(e){return!t.query.title||e.code.toLowerCase().includes(t.query.title.toLowerCase())}),"default-sort":{prop:"id",order:"ascending"},fit:""}},[a("el-table-column",{attrs:{label:"ID",prop:"id",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{label:"Código",prop:"code",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"Valor do Desconto",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.formatDiscountValue(e.row)))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"Quantidade",prop:"quantity",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{align:"right",width:"200"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-input",{key:e.row?e.row.id:"-",attrs:{size:"mini",placeholder:"Filtrar",clearable:""},on:{clear:t.handleClearSearch},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleSearch(e):null}},model:{value:t.query.title,callback:function(e){t.$set(t.query,"title",e)},expression:"query.title"}})]}},{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){t.handleEdit(e.row.id)}}},[t._v("Editar")])]}}])})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.coupons.pagination.total&&t.coupons.pagination.total>0,expression:"coupons.pagination.total && coupons.pagination.total > 0"}],attrs:{total:t.coupons.pagination.total?t.coupons.pagination.total:0,page:t.query.page,limit:t.query.limit},on:{"update:page":function(e){t.$set(t.query,"page",e)},"update:limit":function(e){t.$set(t.query,"limit",e)},pagination:t.fetch}}),t._v(" "),a("el-dialog",{attrs:{visible:t.editDialog,title:"Cupom de Desconto",fullscreen:""},on:{"update:visible":function(e){t.editDialog=e}}},[a("el-row",{staticStyle:{"margin-top":"-25px"},attrs:{gutter:20}},[a("el-form",{ref:"form",attrs:{"label-position":"top"},model:{value:t.formData,callback:function(e){t.formData=e},expression:"formData"}},[a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("Dados do Cupom")])]),t._v(" "),a("el-form-item",{attrs:{label:"Código"}},[a("el-input",{attrs:{placeholder:"Insira o código do cupom de desconto aqui"},model:{value:t.couponCode,callback:function(e){t.couponCode=e},expression:"couponCode"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Tipo"}},[a("el-radio",{attrs:{label:"percent"},model:{value:t.discountType,callback:function(e){t.discountType=e},expression:"discountType"}},[t._v("Procentagem")]),t._v(" "),a("el-radio",{attrs:{label:"currency"},model:{value:t.discountType,callback:function(e){t.discountType=e},expression:"discountType"}},[t._v("Valor Fixo")]),t._v(" "),a("el-radio",{attrs:{label:"free"},model:{value:t.discountType,callback:function(e){t.discountType=e},expression:"discountType"}},[t._v("Gratuito")])],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"Valor do Desconto"}},[a("el-input-number",{attrs:{precision:t.precision,disabled:"free"===t.formData.type,min:0,max:t.maxDiscountValue,placeholder:"Insira o código do cupom de desconto aqui"},model:{value:t.formData.discount,callback:function(e){t.$set(t.formData,"discount",e)},expression:"formData.discount"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Quantas vezes este cupom poderá ser utilizado na loja?",placement:"top"}},[a("el-form-item",{attrs:{label:"Quantidade de Cupons"}},[a("el-input-number",{attrs:{precision:0,min:1,max:1e4,placeholder:"Insira o código do cupom de desconto aqui"},model:{value:t.formData.quantity,callback:function(e){t.$set(t.formData,"quantity",e)},expression:"formData.quantity"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Este cupom pode ser utilizado em conjunto com outros cupons?"}},[a("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"Sim, pode!","inactive-text":"Não, não pode!"},model:{value:t.formData.recursive,callback:function(e){t.$set(t.formData,"recursive",e)},expression:"formData.recursive"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("Aplicabilidade do Cupom")])]),t._v(" "),a("el-form-item",{attrs:{label:"Desejar especificar a Validade do Cupom?"}},[a("el-switch",{staticStyle:{"margin-bottom":"20px"},attrs:{"active-value":!0,"inactive-value":!1},model:{value:t.valid_period,callback:function(e){t.valid_period=e},expression:"valid_period"}}),t._v(" "),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:!t.valid_period,format:"dd-MM-yyyy",type:"daterange","range-separator":"Até","start-placeholder":"Data Inicial","end-placeholder":"Data Final"},model:{value:t.valid_range,callback:function(e){t.valid_range=e},expression:"valid_range"}})],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Escolha um ou mais clientes que serão beneficiados pelo cupom",placement:"top"}},[a("el-form-item",{attrs:{label:"Clientes Beneficiados"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{"remote-method":t.handleSearchClients,loading:t.searchingClients,"loading-text":"Procurando Clientes",filterable:"",multiple:"",remote:"",placeholder:"Insira o nome de algum cliente"},model:{value:t.formData.users,callback:function(e){t.$set(t.formData,"users",e)},expression:"formData.users"}},t._l(t.clientList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Escolha um ou mais produtos onde este cupom poderá ser aplicado",placement:"top"}},[a("el-form-item",{attrs:{label:"Produtos Aplicáveis"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{loading:t.searchingProducts,"remote-method":t.handleSearchProducts,remote:"",multiple:"",filterable:"",placeholder:"Insira o nome de algum produto","loading-text":"Procurando Produtos"},model:{value:t.formData.products,callback:function(e){t.$set(t.formData,"products",e)},expression:"formData.products"}},t._l(t.productList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)],1)],1)],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(e){t.confirmDeleteDialog=!0}}},[t._v("Deletar")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("Salvar")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.confirmDeleteDialog,width:"30%",title:"Confirmar Deleção","append-to-body":"",center:""},on:{"update:visible":function(e){t.confirmDeleteDialog=e}}},[a("span",[t._v("Você tem certeza que deseja deletar este Cupom?")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.confirmDeleteDialog=!1}}},[t._v("Cancelar")]),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:t.handleDelete}},[t._v("Deletar")])],1)])],1)],1)},[],!1,null,null,null);h.options.__file="index.vue";e.default=h.exports}}]);